% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fql-helpers.R
\name{.estimate_var_spline}
\alias{.estimate_var_spline}
\title{Estimate Variance Function via P-Spline}
\usage{
.estimate_var_spline(mu, resid_sq, use_log_link = TRUE)
}
\arguments{
\item{mu}{Fitted mean vector.}

\item{resid_sq}{Squared residuals (y - mu)^2.}

\item{use_log_link}{Whether to use log link in the GAM for variance
estimation. TRUE for the standard fql, FALSE when fitting with
identity link on the variance (fql_log style).}
}
\value{
List with v (estimated variance vector) and gam_fit (the GAM object).
}
\description{
Uses mgcv::gam() with P-spline basis to estimate V(mu) nonparametrically,
as described in Step 2 of the estimation procedure (Equation 5).
}
\keyword{internal}
