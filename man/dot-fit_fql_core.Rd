% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fql-helpers.R
\name{.fit_fql_core}
\alias{.fit_fql_core}
\title{Fit FQL Model with a Specific Variance Estimation Method}
\usage{
.fit_fql_core(
  x,
  y,
  beta_init,
  offset = NULL,
  var_method = "spline",
  bw = NULL,
  tol = 1e-05,
  max_outer = 100,
  max_inner = 100,
  use_log_spline = TRUE
)
}
\arguments{
\item{x}{Design matrix (n x p).}

\item{y}{Response vector.}

\item{beta_init}{Initial beta estimate.}

\item{offset}{Optional offset vector.}

\item{var_method}{Variance estimation method: "spline", "kernel", or "constant".}

\item{bw}{Bandwidth for kernel method.}

\item{tol}{Convergence tolerance.}

\item{max_outer}{Maximum outer iterations (alternating V and beta).}

\item{max_inner}{Maximum inner iterations (IRLS for beta).}

\item{use_log_spline}{Whether to log-transform residuals for spline fitting.}
}
\value{
List with fitting results.
}
\description{
Core inner fitting routine. Alternates between estimating the variance
function V(mu) and re-estimating beta until convergence.
}
\keyword{internal}
